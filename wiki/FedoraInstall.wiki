#summary Notes on the installation of Fedora Commons to Tomcat on andsdb-server

= Introduction =

Fedora Commons is a repository system which we are using to store RIF-CS and other objects and Metadata.

= Prerequisites =

  * Packages:
   * Apache
   * Tomcat6
   * MySQL

  * Other changes
   * User ands-shared (or equiv) should contain the apache and tomcat users, as well as any developers working on the system


= Details =

 * got Fedora Commons jar installer 
  * ( fcrepo-installer-3.4.2.jar @ /home/ands-shared/ )
 * Need to add Envvars to tomcat (in this case, /etc/profile to share these envvars with all users.)
  * JAVA_HOME 
  * FEDORA_HOME (e.g. /ands/fedora)
  * PATH (add $FEDORA_HOME/server/bin, $FEDORA_HOME/client/bin and $JAVA_HOME/bin. )
  * CATALINA_HOME (=/usr/share/tomcat6, or your tomcat install location)
  * CLASSPATH (e.g. /usr/share/java:/etc/alternatives/javac:/usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0.x86_64/bin:/usr/share/java/tomcat6:$PATH)

 * modified mysql database -  why can't the installer handle this?
  * added fedora user
  * added fedora3 database
  * added authority database
  * Gave relevant permissions over these dbs to fedora user

 * ran installer (./java -jar fcrepo-installer-3.4.2.jar)

 NOTE: Was missing /usr/share/tomcat6/common/lib/mysql-connector-java-5.1.6.jar for JDBC connector. Located and added manually.

 ADDENDUM: Was ACTUALLY missing apache packages commons-dbcp-1.4 and commons-pool-1.5.5 as well. These should be placed in the same directory as the mysql-connector-java.jar and this path should be reported in the appropriate place when running the fcrepo installer. Note that catalina.properties does not appear to build the CLASSPATH envvar as reported, so these files will need to be placed somewhere tomcat can access them. The obvious place is /usr/share/tomcat6/lib

 NOTE: target dir should be owned by the designated fedora user. Dir will be chmodded 766 by the installer.

Enabled the JMS interface so that we can listen for updates to datastreams, by editing /ands/fedora/server/config/fedora.fcfg

Changed the //module[@class="org.fcrepo.server.messaging.MessagingModule"]/param[@name="enabled"]/@value to "true"