#summary Installation of the Digital Archaeological Record
=tDAR Install=

Source code. Adam Brin provided a tarball of the `src` folder of the `eolian` branch, but didn't include the pom.xml (Maven build file), so I downloaded it separately from their repository:
{{{
wget http://dev.tdar.org/fisheye/browse/~raw,r=2432/tDAR/branches/eolian/pom.xml
}}}

tDAR is a Java app, built with Maven. 

==Maven==

Yum appears (as of 12/7/11) to only have an ancient build of Maven available (2.0.8), and this is earlier than the minimun required version.

Downloaded Maven 2.2.1 from http://www.apache.org/dyn/closer.cgi/maven/binaries/apache-maven-2.2.1-bin.tar.gz and installed manually (ln -s /bin -> usr/bin, /lib -> /var/lib/, etc).

Followed instructions at: http://dev.tdar.org/confluence/display/TDAR/deploying+tDAR up to and including the step of running the Maven build.

(When renaming the .production files, I moved any files which would have been overwritten into a "backup" folder).

==tDAR configuration==

tDAR is configured with a bunch of property files.

These have been changed as follows: 

===/ands/tDAR-install/src/main/resources/log4j.properties===
Replaced Adam Brin's email with Daniel's and Conal's.
Replaced file appender path /logs/tdar.log with /var/log/tdar/tdar.log

===/ands/tDAR-install/src/main/resources/tdar.properties===
changed file.store.location to /home/tdar/filestore
changed personal.file.store.location to /home/tdar/personal-filestore

===/ands/tDAR-install/src/main/resources/hibernate.properties===

changed javax.persistence.jdbc.user to tomcat due to postgre ident (can be changed later).
added javax.persistence.jdbc.password
changed hibernate.search.default.indexBase to /home/tdar/indexes


==Crowd==
tDAR uses Atlassian "Crowd" for authentication:

http://confluence.atlassian.com/display/CROWD/Installing+Crowd+and+CrowdID

Installed Postgres-server via Yum, and added the Postgre JDBC driver from http://jdbc.postgresql.org/download/postgresql-8.4-701.jdbc4.jar to /usr/share/tomcat6/lib

Followed directions at http://confluence.atlassian.com/display/CROWD/PostgreSQL for setting up database: Added user crowduser (with createdb and createuser) and database crowddb. Gave access to crowddb.`*` to crowduser.

added setclasspath.sh (located in apache-tomcat/bin/ to $TOMCAT_HOME/bin (/usr/share/tomcat6/bin) as it is required to be there by apache-tomcat/bin/startup.sh

ran build.sh

ran start_crowd.sh

Discovered that this config is appropriate for standalone installs, we just need the .WAR

altered /WEB-INF/classes/crowd.properties to reflect actual WAR location (/ands/crowd/)

Created /usr/share/tomcat6/conf/Catalina/localhost/crowd.xml with the following info: 

{{{<Context path="/crowd" docBase="/ands/crowd" reloadable="false"/>}}}

==tDAR==
http://dev.tdar.org/fisheye/browse/tDAR/branches/eolian/src/main/resources/crowd.properties.production?r=2188&r=2188



The Crowd groups which tDAR expects are defined in an enum here:
http://dev.tdar.org/fisheye/browse/tDAR/branches/eolian/src/main/java/org/tdar/core/service/CrowdService.java?hb=true#to47

Daniel has installed Crowd. Daniel: please document that here.